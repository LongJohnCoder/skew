namespace js { void minify() {

testMinify("
class Foo {
  int foo;
}
class Bar {
  int bar;
}
export int foo() {
  return Foo(100).foo + Bar(200).bar;
}
", "
function b(a){this.a=a}function c(a){this.a=a}function foo(){return new b(100).a+new c(200).a|0}
");

testMinify("
class Foo {
  int foo;
}
class Bar : Foo {
  int bar;
}
export int foo() {
  return Foo(100).foo + Bar(200, 300).foo;
}
", "
function $extends(d,b){d.prototype=Object.create(b.prototype);d.prototype.constructor=d}function c(a){this.a=a}function d(a,b){c.call(this,a),this.b=b}$extends(d,c);function foo(){return new c(100).a+new d(200,300).a|0}
");

testMinify("
import int a();
export int foo(int x) {
  return a() + x;
}
", "
function foo(b){return a()+b|0}
");

testMinify("
import namespace a {
  import int b();
}
export int foo(int b) {
  return a.b() + b;
}
", "
function foo(b){return a.b()+b|0}
");

testMinify("
export void foo(int foo) { int bar, baz; }
export void bar(int foo, int bar) { int baz; }
export void baz(int foo, int bar, int baz) {}
", "
function foo(a){var b=0,c=0;}function bar(a,b){var c=0;}function baz(a,b,c){}
");

testMinify("
export int foo() {
  return untyped(0) in 1;
}
", "
function foo(){return 0 in 1}
");

testMinify("
export int foo(int foo) {
  return foo + +1;
}
", "
function foo(a){return a+1|0}
");

testMinify("
export int foo(int foo) {
  return foo - -1;
}
", "
function foo(a){return a- -1|0}
");

testMinify("
export int foo(void fn() foo) {
  foo();
  return 1;
}
", "
function foo(a){return a(),1}
");

testMinify("
export int foo(void fn() foo) {
  foo();
  foo();
  return 1;
}
", "
function foo(a){return a(),a(),1}
");

testMinify("
export int foo(int foo) {
  if (foo < 0) return -1;
  else if (foo > 0) return 1;
  else return 1;
}
", "
function foo(a){return a<0?-1:a>0?1:1}
");

testMinify("
export int foo(int foo) {
  if (foo < 0) return -1;
  if (foo > 0) return 1;
  return 1;
}
", "
function foo(a){return a<0?-1:a>0?1:1}
");

testMinify("
export int foo(int x, void fn() y) {
  if (x < 0) {
    y();
    return 1;
  }
  return 2;
}
", "
function foo(a,b){return a<0?(b(),1):2}
");

testMinify("
export int foo() {
  int foo;
  int bar;
  return foo + bar;
}
", "
function foo(){var a=0,b=0;return a+b|0}
");

testMinify("
const bool bar = false;
export int foo(int y) {
  if (y < 0) {
    return -y;
  } else if (bar) {
    return 100;
  }
  return y;
}
", "
function foo(a){return a<0?-a:a}
");

testMinify("
export int foo(int y) {
  if (y > 0) y++;
  else if (y < 0) y += 2;
  else y--;
  return y;
}
", "
function foo(a){return a=(a>0?a+1:a<0?a+2:a-1)|0,a}
");

testMinify("
export int foo(int x, int y) {
  if (x < 0) {
    x++;
    y--;
  } else if (y < 0) {
    x -= y;
  } else {
    x--;
    y++;
  }
  return y;
}
", "
function foo(a,b){return a<0?(a=a+1|0,b=b-1|0):b<0?a=a-b|0:(a=a-1|0,b=b+1|0),b}
");

testMinify("
export bool foo(int x, int y) {
  var bar = x == 0 && y != 0;
  if (x == 0 && y != 0) return true;
  else return bar;
}
", "
function foo(a,b){var c=a===0&&b!==0;return !a&&b?!0:c}
");

testMinify("
export bool foo(float x, double y) {
  var bar = x == 0 && y != 0;
  if (x == 0 && y != 0) return true;
  else return bar;
}
", "
function foo(a,b){var c=a===0&&b!==0;return a===0&&b!==0?!0:c}
");

testMinify("
export bool foo(void fn() fn() x) {
  var bar = x != null && x() == null;
  if (x != null && x() == null) return true;
  else return bar;
}
", "
function foo(a){var b=a!==null&&a()===null;return a&&!a()?!0:b}
");

testMinify("
export bool foo(string x) {
  var bar = x == \"\" || x.slice(1, 2) == \"\";
  if (x == \"\" || x.slice(1, 2) == \"\") return true;
  else return bar;
}
", "
function foo(a){var b=a===\"\"||a.slice(1,2)===\"\";return !a||!a.slice(1,2)?!0:b}
");

testMinify("
export void foo(bool fn() foo, void fn() bar) {
  if (foo()) {
    bar();
    if (foo()) {
      bar();
      if (foo()) bar();
    }
  }
}
", "
function foo(a,b){a()&&(b(),a()&&(b(),a()&&b()))}
");

testMinify("
export int foo(int a, int b) {
  return a != b ? 1 : 2;
}
", "
function foo(a,b){return a^b?1:2}
");

testMinify("
export void foo(bool a, void fn() b) {
  if (!a) b();
}
", "
function foo(a,b){!a&&b()}
");

testMinify("
export int foo(bool a, void fn() b) {
  if (!a) {
    b();
    return 1;
  } else {
    return 2;
  }
}
", "
function foo(a,b){return a?2:(b(),1)}
");

testMinify("
export int foo(bool a) {
  return !a ? 1 : 2;
}
", "
function foo(a){return a?2:1}
");

testMinify("
export void foo(Foo a, Foo b, void fn() c, void fn() d) {
  if (a == b) c();
  else d();
}
enum Foo {}
", "
function foo(a,b,c,d){a^b?d():c()}
");

testMinify("
export int foo(int x) {
  int y;
  switch (x) {
    case 1 { y = 1; }
    case 2 { y = 2; }
  }
  return y;
}
", "
function foo(b){var a=0;switch(b){case 1:a=1;break;case 2:a=2}return a}
");

testMinify("
export bool foo(int a) {
  return a >= 5 && a <= 8;
}
export bool bar(int a) {
  return 5 <= a && 8 >= a;
}
", "
function foo(a){return a>4&&a<9}function bar(a){return 4<a&&9>a}
");

testMinify("
export void foo(bool x, void fn() y) {
  if (x) return;
  y();
  y();
}
", "
function foo(b,a){!b&&(a(),a())}
");

testMinify("
export void foo(bool x, void fn() y) {
  if (x) return;
  y();
  if (x) return;
  y();
}
", "
function foo(a,b){!a&&(b(),!a&&b())}
");

testMinify("
export void foo(bool x, bool y, void fn() z) {
  if (x) {
    if (y) return;
    z();
    z();
  }
}
", "
function foo(b,c,a){b&&(!c&&(a(),a()))}
");

testMinify("
export void foo(bool x, bool y, void fn() z) {
  if (x) {
    if (y) return;
    z();
    z();
  }
  z();
}
", "
function foo(b,c,a){if(b){if(c)return;a(),a()}a()}
");

testMinify("
export void foo(bool x, void fn() y) {
  if (x) {
    y();
    return;
  }
  y();
  y();
}
", "
function foo(b,a){b?a():(a(),a())}
");

testMinify("
export void foo(bool x, bool y, void fn() z) {
  while (x) {
    if (y) return;
    z();
    z();
  }
}
", "
function foo(b,c,a){while(b){if(c)return;a(),a()}}
");

testMinify("
export void foo(bool x, bool y, void fn() z) {
  while (x) {
    if (y) continue;
    z();
    z();
  }
}
", "
function foo(b,c,a){while(b)!c&&(a(),a())}
");

testMinify("
export void foo(bool x, bool y, void fn() z) {
  while (x) {
    if (y) continue;
    z();
    if (y) continue;
    z();
  }
}
", "
function foo(c,a,b){while(c)!a&&(b(),!a&&b())}
");

testMinify("
export void foo(bool x, bool y, void fn() z) {
  while (x) {
    if (y) {
      z();
      if (y) continue;
      z();
      z();
    }
  }
}
", "
function foo(c,b,a){while(c)b&&(a(),!b&&(a(),a()))}
");

testMinify("
export void foo(bool x, bool y, void fn() z) {
  while (x) {
    if (y) {
      z();
      if (y) continue;
      z();
      z();
    }
    z();
  }
}
", "
function foo(c,b,a){while(c){if(b){a();if(b)continue;a(),a()}a()}}
");

testMinify("
export void foo(bool x, bool y, void fn() z) {
  while (x) {
    if (y) {
      z();
      continue;
    }
    z();
    z();
  }
}
", "
function foo(b,c,a){while(b)c?a():(a(),a())}
");

}}
